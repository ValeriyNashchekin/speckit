<p-dialog
  [header]="dialogTitle()"
  [visible]="visible()"
  [modal]="true"
  [closable]="true"
  [draggable]="true"
  [resizable]="false"
  [style]="{ width: '32rem' }"
  (onHide)="onHide()"
>
  <form [formGroup]="categoryForm" class="space-y-4">
    <!-- Name field -->
    <div class="flex flex-col gap-2">
      <label for="categoryName" class="text-sm font-medium text-gray-700">
        Name <span class="text-red-500">*</span>
      </label>
      <input
        pInputText
        id="categoryName"
        formControlName="name"
        class="w-full"
        [class.ng-invalid]="isFieldInvalid('name')"
        [class.ng-dirty]="categoryForm.get('name')?.dirty"
        placeholder="Enter category name"
        aria-describedby="nameError"
      />
      @if (isFieldInvalid('name')) {
        <small id="nameError" class="text-red-500 text-xs">
          @if (categoryForm.get('name')?.errors?.['required']) {
            Name is required
          }
          @if (categoryForm.get('name')?.errors?.['minlength']) {
            Name must be at least 1 character
          }
          @if (categoryForm.get('name')?.errors?.['maxlength']) {
            Name cannot exceed 100 characters
          }
        </small>
      }
    </div>

    <!-- Description field -->
    <div class="flex flex-col gap-2">
      <label for="categoryDescription" class="text-sm font-medium text-gray-700">Description</label>
      <textarea
        pTextarea
        id="categoryDescription"
        formControlName="description"
        rows="3"
        class="w-full"
        [class.ng-invalid]="isFieldInvalid('description')"
        placeholder="Enter description (optional)"
        [maxlength]="500"
        aria-describedby="descCounter"
      ></textarea>
      <small id="descCounter" class="text-gray-400 text-xs text-right">
        {{ categoryForm.get('description')?.value?.length || 0 }}/500
      </small>
    </div>

    <!-- Sort Order field -->
    <div class="flex flex-col gap-2">
      <label for="categorySortOrder" class="text-sm font-medium text-gray-700">Sort Order</label>
      <p-inputNumber
        inputId="categorySortOrder"
        formControlName="sortOrder"
        [min]="0"
        [showButtons]="true"
        buttonLayout="horizontal"
        spinMode="vertical"
        class="w-full"
      />
      <small class="text-gray-500 text-xs">Higher numbers appear later in the list</small>
    </div>
  </form>

  <ng-template #footer>
    <div class="flex justify-end gap-2">
      <p-button
        label="Cancel"
        severity="secondary"
        [outlined]="true"
        (onClick)="onCancel()"
      />
      <p-button
        [label]="isEditMode() ? 'Update' : 'Create'"
        severity="primary"
        (onClick)="onSave()"
        [disabled]="categoryForm.invalid || isSubmitting()"
      />
    </div>
  </ng-template>
</p-dialog>
