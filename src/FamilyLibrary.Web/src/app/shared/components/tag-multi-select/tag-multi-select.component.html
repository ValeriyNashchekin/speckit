<p-multiSelect
  [options]="tags()"
  [ngModel]="selectedTags()"
  (ngModelChange)="onSelectionChange($event)"
  [placeholder]="placeholder()"
  [disabled]="disabled()"
  [readonly]="readonly()"
  [maxSelectedLabels]="maxSelectedLabels()"
  [showClear]="showClear()"
  [fluid]="fluid()"
  optionLabel="name"
  dataKey="id"
  display="chip"
  selectedItemsLabel="{0} tags selected"
  class="w-full"
>
  <ng-template #item let-tag>
    <div class="flex items-center gap-2">
      <span
        class="w-3 h-3 rounded-full flex-shrink-0"
        [style.background-color]="getTagColor(tag)"
        [attr.aria-label]="'Tag color: ' + tag.name"
      ></span>
      <span class="truncate">{{ tag.name }}</span>
    </div>
  </ng-template>

  <ng-template #selecteditems let-selectedTags>
    <div class="flex flex-wrap gap-1">
      @for (tag of selectedTags; track tag.id) {
        <span
          class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full text-white"
          [style.background-color]="getTagColor(tag)"
        >
          {{ tag.name }}
        </span>
      }
    </div>
  </ng-template>
</p-multiSelect>
