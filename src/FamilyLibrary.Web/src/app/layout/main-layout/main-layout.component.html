<div class="flex h-screen overflow-hidden bg-[var(--surface-ground)]">
  <aside
    class="fixed left-0 top-0 h-screen flex flex-col z-50 bg-white border-r border-[var(--border-subtle)] transition-[width] duration-200 ease-out"
    [style.width]="collapsed() ? 'var(--sidebar-collapsed-width)' : 'var(--sidebar-width)'"
  >
    <div
      class="flex items-center h-12 border-b border-[var(--border-subtle)] shrink-0"
      [class.justify-center]="collapsed()"
      [class.px-4]="!collapsed()"
      [class.gap-2.5]="!collapsed()"
    >
      <button
        type="button"
        class="w-7 h-7 flex items-center justify-center rounded-md hover:bg-gray-100 text-[var(--text-secondary)] transition-colors"
        (click)="toggleSidebar()"
        [attr.aria-label]="collapsed() ? 'Expand sidebar' : 'Collapse sidebar'"
      >
        <i class="pi pi-bars text-sm"></i>
      </button>
      @if (!collapsed()) {
        <span class="text-sm font-semibold text-[var(--text-primary)] tracking-tight whitespace-nowrap">
          speckit
        </span>
      }
    </div>

    <nav class="flex-1 overflow-y-auto py-2" role="navigation" aria-label="Main navigation">
      @for (group of navGroups(); track group.title) {
        @if (group.title && !collapsed()) {
          <div class="px-3 pt-4 pb-1">
            <span class="text-[0.625rem] font-semibold uppercase tracking-wider text-[var(--text-muted)]">
              {{ group.title }}
            </span>
          </div>
        }
        @if (group.title && collapsed()) {
          <div class="mx-2 my-1 border-t border-[var(--border-subtle)]"></div>
        }
        <ul class="space-y-0.5 px-2">
          @for (item of group.items; track item.route) {
            <li>
              <a
                [routerLink]="item.route"
                routerLinkActive="bg-[var(--accent-soft)] text-[var(--accent)]"
                class="flex items-center gap-2.5 rounded-md text-[var(--text-secondary)] hover:bg-gray-50 transition-colors"
                [class.px-2.5]="!collapsed()"
                [class.py-1.5]="true"
                [class.justify-center]="collapsed()"
                [pTooltip]="collapsed() ? item.label : ''"
                tooltipPosition="right"
              >
                <i [class]="item.icon" class="text-[0.9rem] w-5 text-center shrink-0"></i>
                @if (!collapsed()) {
                  <span class="text-[0.8125rem] font-medium truncate">{{ item.label }}</span>
                }
              </a>
            </li>
          }
        </ul>
      }
    </nav>

    <div class="shrink-0 border-t border-[var(--border-subtle)] py-2 px-2">
      <a
        routerLink="/settings"
        routerLinkActive="bg-[var(--accent-soft)] text-[var(--accent)]"
        class="flex items-center gap-2.5 rounded-md text-[var(--text-secondary)] hover:bg-gray-50 transition-colors"
        [class.px-2.5]="!collapsed()"
        [class.py-1.5]="true"
        [class.justify-center]="collapsed()"
        [pTooltip]="collapsed() ? 'Settings' : ''"
        tooltipPosition="right"
      >
        <i class="pi pi-cog text-[0.9rem] w-5 text-center shrink-0"></i>
        @if (!collapsed()) {
          <span class="text-[0.8125rem] font-medium">Settings</span>
        }
      </a>
    </div>
  </aside>

  <div
    class="flex-1 flex flex-col min-h-screen transition-[margin-left] duration-200 ease-out"
    [style.margin-left]="collapsed() ? 'var(--sidebar-collapsed-width)' : 'var(--sidebar-width)'"
  >
    <main class="flex-1 overflow-auto">
      <router-outlet />
    </main>
  </div>
</div>

<p-confirmdialog />
<p-toast position="bottom-right" />
