<Window
    x:Class="FamilyLibrary.Plugin.Commands.LoadFamilyCommand.Views.TypeSelectionWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:viewModel="clr-namespace:FamilyLibrary.Plugin.Commands.LoadFamilyCommand.ViewModels"
    mc:Ignorable="d"
    d:DataContext="{d:DesignInstance viewModel:TypeSelectionViewModel}"
    Title="Select Types to Load"
    Width="700"
    Height="500"
    ResizeMode="CanResize"
    WindowStartupLocation="CenterOwner">

    <Window.Resources>
        <Style x:Key="SearchTextBoxStyle" TargetType="TextBox">
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
        <Style x:Key="ToolbarButtonStyle" TargetType="Button">
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Background" Value="#F0F0F0"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>
        <Style x:Key="SelectedCountTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="#666666"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        <Style x:Key="DataGridStyle" TargetType="DataGrid">
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="SelectionMode" Value="Extended"/>
            <Setter Property="AlternatingRowBackground" Value="#F9F9F9"/>
        </Style>
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Padding" Value="15,6"/>
            <Setter Property="MinWidth" Value="100"/>
            <Setter Property="Background" Value="#0078D4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Medium"/>
        </Style>
        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Padding" Value="15,6"/>
            <Setter Property="MinWidth" Value="80"/>
            <Setter Property="Background" Value="#F0F0F0"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>
        <Style x:Key="DataGridRowStyle" TargetType="DataGridRow">
            <EventSetter Event="MouseDoubleClick" Handler="OnRowDoubleClick"/>
        </Style>
    </Window.Resources>

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Search TextBox -->
        <Grid Grid.Row="0" Margin="0,0,0,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <TextBox Grid.Column="0"
                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                     Style="{StaticResource SearchTextBoxStyle}"
                     VerticalContentAlignment="Center">
                <TextBox.ToolTip>
                    <ToolTip Content="Search types by name"/>
                </TextBox.ToolTip>
            </TextBox>
            <!-- Search hint icon -->
            <TextBlock Grid.Column="0"
                       Text="&#x1F50D;"
                       FontSize="14"
                       Foreground="#999999"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Right"
                       Margin="0,0,10,0"
                       IsHitTestVisible="False"/>
        </Grid>

        <!-- Select All / None and Counter -->
        <Grid Grid.Row="1" Margin="0,0,0,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Column="0"
                    Content="Select All"
                    Command="{Binding SelectAllCommand}"
                    Style="{StaticResource ToolbarButtonStyle}"
                    Margin="0,0,4,0"/>
            <Button Grid.Column="1"
                    Content="Select None"
                    Command="{Binding SelectNoneCommand}"
                    Style="{StaticResource ToolbarButtonStyle}"/>
            <TextBlock Grid.Column="3"
                       Text="{Binding SelectedCount, StringFormat='Selected: {0} types'}"
                       Style="{StaticResource SelectedCountTextStyle}"/>
        </Grid>

        <!-- DataGrid with Types -->
        <DataGrid Grid.Row="2"
                  ItemsSource="{Binding FilteredTypes}"
                  Style="{StaticResource DataGridStyle}"
                  RowStyle="{StaticResource DataGridRowStyle}">
            <DataGrid.Columns>
                <DataGridCheckBoxColumn Header="Select"
                                        Binding="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}"
                                        Width="60"/>
                <DataGridTextColumn Header="Type Name"
                                    Binding="{Binding TypeName}"
                                    Width="*"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Buttons -->
        <Grid Grid.Row="3" Margin="0,12,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Column="1"
                    Content="Cancel"
                    Command="{Binding CancelCommand}"
                    Style="{StaticResource SecondaryButtonStyle}"
                    IsCancel="True"/>
            <Button Grid.Column="3"
                    Content="Load Selected"
                    Command="{Binding LoadCommand}"
                    Style="{StaticResource PrimaryButtonStyle}"
                    IsDefault="True"/>
        </Grid>
    </Grid>
</Window>
